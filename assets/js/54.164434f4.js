(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{395:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"前端路由的原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前端路由的原理"}},[t._v("#")]),t._v(" 前端路由的原理")]),t._v(" "),a("p",[t._v("react-router 等前端路由的原理大致相同，可以实现无刷新的条件下切换显示不同的页面。")]),t._v(" "),a("p",[t._v("路由本质就是页面 URL 发生改变时，页面的显示结果也根据URL的变化而变化，但是页面不会刷新。")]),t._v(" "),a("h2",{attrs:{id:"hash-实现前端路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hash-实现前端路由"}},[t._v("#")]),t._v(" hash 实现前端路由")]),t._v(" "),a("h3",{attrs:{id:"一、hash-的原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、hash-的原理"}},[t._v("#")]),t._v(" 一、hash 的原理")]),t._v(" "),a("p",[t._v("早期的路由就是通过 hash 来实现的，"),a("strong",[t._v("改变 URL 的 hash 值是不会刷新页面的")]),t._v("。如下面列子所示：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hash "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"edit"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// http://localhost:3000       改变前")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// http://localhost:3000/#edit 改变后")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("当路由改变后可以用 onhashchange 事件来监听，根据变化来展示和隐藏相应的页面。")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("routeTo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("targetName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 location.hash 跳转")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'jump to route name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("targetName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  location"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hash "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" targetName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取跳转的路由")]),t._v("\nwindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hashchange"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 或者")]),t._v("\nwindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onhashchange")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br")])]),a("h3",{attrs:{id:"二、hash-的缺点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、hash-的缺点"}},[t._v("#")]),t._v(" 二、hash 的缺点")]),t._v(" "),a("p",[t._v("hash 的兼容性较好，但是也有许多缺点")]),t._v(" "),a("ul",[a("li",[t._v("搜索引擎对带有 hash 的页面不太友好")]),t._v(" "),a("li",[t._v("带有 hash 的页面内难以追踪用户行为")])]),t._v(" "),a("h2",{attrs:{id:"history-实现前端路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#history-实现前端路由"}},[t._v("#")]),t._v(" History 实现前端路由")]),t._v(" "),a("p",[t._v("H5 的 History 是一个底层的接口，不继承任何的接口。History 允许我们操作浏览器会话历史记录。")]),t._v(" "),a("h3",{attrs:{id:"一、history的属性和方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、history的属性和方法"}},[t._v("#")]),t._v(" 一、History的属性和方法")]),t._v(" "),a("p",[t._v("History 提供一些属性和方法如下所示：")]),t._v(" "),a("p",[t._v("History 的属性：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("History.length")]),t._v(" 返回在会话历史中有多少条记录，包含了当前的会话页面。如果打开一个新的浏览器窗口，那么 length 的值为 1。")]),t._v(" "),a("li",[a("code",[t._v("History.state")]),t._v(" 保存了会发出 popState 事件的方法，所传递过来的属性对象。")])]),t._v(" "),a("p",[t._v("History 的方法：")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("History.back()")]),t._v(" 返回浏览器历史会话中的上一页，跟浏览器的回退功能相同。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("History.forward()")]),t._v(" 指向浏览器历史中的下一页，跟浏览器的前进功能相同。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("History.go()")]),t._v(" 可以跳转到浏览器会话历史中的某一个记录页。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("History.pushState()")]),t._v(" pushState 可以将给定的数据压入到浏览器会话历史栈中，该方法接收 3 个参数，对象，title 和一串 url。\npushState 后会改变当前页面的 url，但是不会伴随着刷新。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("History.replaceState()")]),t._v(" replaceState 将当前页面的 url 替换成指定的数据，replaceState 后会改变当前页面的 url，但是不会刷新页面。")])])]),t._v(" "),a("p",[t._v("pushState 和 replaceState 的相同点，"),a("strong",[t._v("都会改变当前页面的 url，但是不会刷新页面")]),t._v("。")]),t._v(" "),a("p",[t._v("不同点是"),a("strong",[t._v("pushState 是压入浏览器的会话栈中的，会使得 history.length 加 1，而 replaceState 是替换当前的这条会话历史，因此不会增加 length")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"二、bom-对象的-history"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、bom-对象的-history"}},[t._v("#")]),t._v(" 二、BOM 对象的 history")]),t._v(" "),a("p",[t._v("history 是浏览器在 BOM 对象模型中的重要属性，history 完全继承了 History 接口，因此拥有其身上的所有属性和方法。")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("routeTo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("targetName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'jump to route name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("targetName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("targetName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("targetName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("page_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" targetName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);